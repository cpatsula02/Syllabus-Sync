<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syllabus Sync - University of Calgary</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark">
            <div class="container">
                <a class="navbar-brand" href="/">
                    <img src="/static/images/uofc_logo.svg" alt="University of Calgary Logo" height="50">
                </a>
                <span class="navbar-brand">Syllabus Sync</span>
            </div>
        </nav>
    </header>

    <main class="container my-4">
        
            
        
        
        
<div class="container mt-4">
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <a href="/" class="btn btn-secondary">
                    <i class="fas fa-arrow-left me-2"></i>Back to Home
                </a>
                <div>
                    <a href="/download_pdf" target="_blank" class="btn btn-success">
                        <i class="fas fa-file-pdf me-2"></i>View PDF Report
                    </a>
                </div>
            </div>
        </div>
    </div>

    <h1 class="mb-4">Syllabus Sync Analysis Results</h1>

    <!-- Enhanced Summary stats -->
    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0"><i class="fas fa-chart-pie me-2"></i>Analysis Summary</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-3">
                    <div class="alert alert-success">
                        <i class="fas fa-check-circle me-2"></i>Present Items: 0
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="alert alert-danger">
                        <i class="fas fa-times-circle me-2"></i>Missing Items: 1
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>Total Items: 1
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="alert alert-primary">
                        <i class="fas fa-robot me-2"></i>AI Verifications: 0
                    </div>
                </div>
            </div>
            
            <!-- AI Verification Information -->
            <div class="row mt-3">
                <div class="col-12">
                    <div class="alert alert-light border p-3">
                        <h6 class="mb-2 fw-bold"><i class="fas fa-brain me-2 text-primary"></i>Multi-Perspective Analysis</h6>
                        <p class="mb-2">Each checklist item was analyzed through multiple perspectives:</p>
                        <div class="d-flex flex-wrap mb-2">
                            <span class="badge bg-info me-2 mb-1 p-2"><i class="fas fa-chalkboard-teacher me-1"></i> Instructor Perspective</span>
                            <span class="badge bg-info me-2 mb-1 p-2"><i class="fas fa-user-graduate me-1"></i> Student Perspective</span>
                            <span class="badge bg-info me-2 mb-1 p-2"><i class="fas fa-university me-1"></i> Administrator Perspective</span>
                        </div>
                        <p class="small text-muted mb-0">The system evaluated each item from different viewpoints to ensure thorough verification, increasing accuracy and reducing false positives.</p>
                    </div>
                </div>
            </div>
            
            
            <div class="row mt-3">
                <div class="col-12">
                    <div class="alert alert-light border p-3">
                        <h6 class="mb-2 fw-bold"><i class="fas fa-tachometer-alt me-2 text-primary"></i>Analysis Methods</h6>
                        <p class="mb-2">The document was analyzed using multiple complementary techniques:</p>
                        <div class="d-flex flex-wrap">
                            
                            <div class="badge bg-secondary me-2 mb-2 p-2">
                                <i class="fas fa-code me-1"></i>
                                Enhanced Pattern Matching: 1
                            </div>
                            
                        </div>
                        
                    </div>
                </div>
            </div>
            
        </div>
    </div>

    <!-- Enhanced Missing items section -->
    
    <div class="card mb-4">
        <div class="card-header bg-danger text-white">
            <h5 class="mb-0">
                <i class="fas fa-exclamation-triangle me-2"></i>Missing Components
            </h5>
        </div>
        <div class="card-body">
            <div class="missing-items-box p-3 border border-danger rounded">
                <h6 class="text-danger mb-3"><strong>The following components are missing from your course outline:</strong></h6>
                
                <div class="alert alert-info mb-3">
                    <i class="fas fa-robot me-2"></i>
                    <strong>AI-Verified Analysis:</strong> These missing items were identified through thorough multi-perspective analysis. Each item was scanned <strong>exactly 3 times</strong> from different analytical viewpoints (instructor, student, and administrator perspectives) to ensure accurate results and minimize false negatives.
                </div>

                <!-- Yellow box with bullet-pointed missing items -->
                <div class="alert alert-warning mb-4">
                    <h6 class="mb-3"><strong><i class="fas fa-exclamation-circle me-2"></i>Missing Components Summary:</strong></h6>
                    <ul class="mb-0">
                        
                            <li class="mb-2 ">
                                Instructor email is included and contains the domain &#34;ucalgary.ca&#34;.
                                
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
    

    <!-- Detailed analysis section -->
    <div class="card mb-4">
        <div class="card-header">
            <h5 class="mb-0">Detailed Checklist Analysis</h5>
        </div>
        <div class="card-body p-0">
            <div class="list-group list-group-flush" id="results-content">
            
                <div class="list-group-item list-group-item-danger ">
                    <div class="d-flex justify-content-between align-items-start">
                        <h5 class="mb-2">
                            
                            Instructor email is included and contains the domain &#34;ucalgary.ca&#34;.
                        </h5>
                        <span class="badge bg-danger">
                            
                            <i class="fas fa-times me-1"></i>Missing
                            
                        </span>
                    </div>

                    <p class="mb-2"><strong>Analysis:</strong> The item was not found in the document.</p>

                    <!-- Detection Method Information -->
                    <p class="mb-2 detection-method">
                        <strong>Detection Method:</strong> 
                        <span class="badge bg-info">Enhanced Pattern Matching</span>
                        
                        <span class="ms-2 text-muted">(Confidence: 20%)</span>
                        

                        
                    </p>
                    
                    <!-- How the item was found/missing explanation -->
                    <div class="explanation-detail mb-3 p-2 rounded bg-danger-light border-danger border">
                        <h6 class="mb-2 fw-bold">Why this item is missing:</h6>
                        <div class="mb-2">
                            
                                <p>
                                
                                    <i class="fas fa-search me-2 text-danger"></i><strong>Pattern Analysis:</strong> The system searched thoroughly for relevant keywords, patterns, phrases, and related concepts throughout the document but could not find sufficient evidence that this requirement is addressed.
                                
                                </p>
                                
                                
                                
                                <p class="mt-2">
                                    <i class="fas fa-exclamation-triangle me-2 text-warning"></i><strong>Detailed Analysis:</strong> 
                                    After multiple scans using different perspectives and advanced semantic analysis, the system was unable to identify content addressing this requirement. The AI analysis engine searched for various phrasings, synonyms, and contextual elements that might indicate the presence of this content, even if not explicitly stated in the same words as the checklist item.
                                </p>
                                <p class="mt-2">
                                    <i class="fas fa-clipboard-list me-2 text-info"></i><strong>Specific Searching:</strong>
                                    
                                        The system searched for semantic matches to this requirement throughout all sections of the document.
                                    
                                </p>
                                <p class="mt-2">
                                    <i class="fas fa-lightbulb me-2 text-warning"></i><strong>Suggested Action:</strong> 
                                    Add a clearly labeled section to your course outline that explicitly addresses this requirement. Based on the analysis, this content should be:
                                    
                                        included with explicit language that clearly addresses the institutional requirements for this item.
                                    
                                </p>
                            
                        </div>
                    </div>
                    
                    <!-- View Evidence Button -->
                    <button class="btn btn-sm btn-outline-danger mb-2" 
                            onclick="loadMatchDetails(this)" 
                            data-item="Instructor email is included and contains the domain &#34;ucalgary.ca&#34;.">
                        <i class="fas fa-search-minus me-1"></i>
                        Search for Missing Content
                    </button>
                    
                    <div class="evidence-box p-3 mt-1 bg-light rounded border-danger" style="display: none;" 
                         id="evidence-1">
                        <div class="spinner-border spinner-border-sm text-secondary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <span>Loading evidence...</span>
                    </div>
                </div>
            
            </div>
        </div>
    </div>
</div>

<style>
/* Flag box styling for missing items */
.flag-box {
    border-radius: 5px;
    margin-bottom: 15px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    overflow: hidden;
}

.flag-header {
    padding: 8px 15px;
    display: flex;
    align-items: center;
    color: white;
}

.grade-flag .flag-header {
    background-color: #dc3545; /* Red for grade items */
}

.regular-flag .flag-header {
    background-color: #ffc107; /* Yellow for regular items */
    color: #212529;
}

.flag-icon {
    margin-right: 10px;
    font-size: 1.2em;
}

.flag-content {
    padding: 12px 15px;
    background-color: #f8f9fa;
    border: 1px solid rgba(0,0,0,0.125);
    border-top: none;
}

/* Evidence box styling */
.evidence-box {
    max-height: 200px;
    overflow-y: auto;
    font-size: 0.95em;
}

/* Explanation detail boxes for present/missing items */
.explanation-detail {
    font-size: 0.9rem;
    line-height: 1.4;
}

.bg-success-light {
    background-color: rgba(25, 135, 84, 0.1);
}

.bg-danger-light {
    background-color: rgba(220, 53, 69, 0.1);
}

/* Highlight matched terms */
.evidence-box span {
    border-radius: 2px;
}

/* Make sure the present items are clearly marked in green */
.list-group-item-success {
    background-color: rgba(25, 135, 84, 0.15);
    border-color: rgba(25, 135, 84, 0.3);
}

.list-group-item-danger {
    background-color: rgba(220, 53, 69, 0.15);
    border-color: rgba(220, 53, 69, 0.3);
}
</style>

<script>
// Function to load and display match details when the View Match button is clicked
function loadMatchDetails(button) {
    const item = button.getAttribute('data-item');
    const evidenceBoxId = button.closest('.list-group-item').querySelector('.evidence-box').id;
    const evidenceBox = document.getElementById(evidenceBoxId);

    // Toggle visibility
    if (evidenceBox.style.display === 'none' || evidenceBox.style.display === '') {
        evidenceBox.style.display = 'block';

        // Fetch the matching details
        fetch(`/get-match-details?item=${encodeURIComponent(item)}`)
            .then(response => response.json())
            .then(data => {
                if (data.found) {
                    evidenceBox.innerHTML = data.excerpt;

                    // Add special styling for grade items
                    if (data.is_grade_item) {
                        evidenceBox.style.borderLeft = '4px solid #fd7e14'; // Orange for grade items
                    }
                } else {
                    evidenceBox.innerHTML = '<em>No detailed evidence available.</em>';
                }
            })
            .catch(error => {
                console.error('Error fetching match details:', error);
                evidenceBox.innerHTML = '<em>Error loading evidence.</em>';
            });
    } else {
        evidenceBox.style.display = 'none';
    }
}
</script>

    </main>

    <footer class="container-fluid py-3 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <p>&copy;  University of Calgary. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p>2500 University Dr NW, Calgary, AB T2N 1N4</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5 JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="/static/js/main.js"></script>
    <script src="/static/js/highlight.js"></script>
    
    <!-- Page-specific scripts -->
    
</body>
</html>